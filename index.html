<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Choose a Game | Gaming Database</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        /* Light Theme Variables */
        :root {
        /* About/Privacy/Terms/Contact Modals */
.legal-modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(10px);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 2002;
    opacity: 0;
    visibility: hidden;
    transition: all var(--transition-smooth);
    padding: 1rem;
}

.legal-modal.active {
    opacity: 1;
    visibility: visible;
}

.legal-modal-content {
    background: var(--color-bg-modal);
    border-radius: 20px;
    width: 100%;
    max-width: 700px;
    max-height: 85vh;
    overflow-y: auto;
    transform: translateY(30px) scale(0.95);
    transition: transform var(--transition-smooth), background-color 0.5s ease;
    box-shadow: var(--shadow-modal);
    border: 1px solid var(--color-border);
    display: flex;
    flex-direction: column;
}

.legal-modal.active .legal-modal-content {
    transform: translateY(0) scale(1);
}

.legal-modal-header {
    padding: 1.5rem 1.5rem 1rem;
    border-bottom: 1px solid var(--color-border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: sticky;
    top: 0;
    background: var(--color-bg-modal);
    z-index: 1;
}

.legal-modal-title {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--color-text-primary);
    transition: color 0.5s ease;
}

.legal-modal-close {
    background: none;
    border: none;
    color: var(--color-text-muted);
    font-size: 1.75rem;
    cursor: pointer;
    padding: 8px;
    transition: color var(--transition-fast);
}

.legal-modal-close:hover {
    color: var(--color-text-primary);
}

.legal-modal-body {
    padding: 1.5rem;
    color: var(--color-text-secondary);
    line-height: 1.7;
}

.legal-modal-section {
    margin-bottom: 2rem;
}

.legal-modal-section:last-child {
    margin-bottom: 0;
}

.legal-modal-section h3 {
    color: var(--color-text-primary);
    margin-bottom: 0.75rem;
    font-size: 1.2rem;
    font-weight: 600;
}

.legal-modal-section h4 {
    color: var(--color-text-secondary);
    margin: 1.5rem 0 0.5rem 0;
    font-size: 1.1rem;
    font-weight: 500;
}

.legal-modal-section p {
    margin-bottom: 1rem;
}

.legal-modal-section ul {
    margin: 0.5rem 0 1rem 1.5rem;
    color: var(--color-text-secondary);
}

.legal-modal-section li {
    margin-bottom: 0.5rem;
}

.legal-modal-section strong {
    color: var(--color-text-primary);
    font-weight: 600;
}

.contact-info {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-top: 1.5rem;
}

.contact-item {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
}

.contact-item i {
    color: var(--color-primary);
    margin-top: 3px;
    font-size: 1.1rem;
    width: 20px;
}

.contact-link {
    color: var(--color-primary);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.contact-link:hover {
    color: var(--color-primary-dark);
    text-decoration: underline;
}
            /* Primary Accents */
            --color-primary: #00b0fc;
            --color-primary-light: #76d5fe;
            --color-primary-dark: #035cc2;
            
            /* Background & Cards */
            --color-bg-main: #f8fafc;
            --color-bg-card: #ffffff;
            --color-bg-hover: #f1f5f9;
            --color-bg-modal: #ffffff;
            
            /* Text Colors */
            --color-text-primary: #1e293b;
            --color-text-secondary: #64748b;
            --color-text-muted: #94a3b8;
            
            /* Accents & UI */
            --color-accent-purple: #8b5cf6;
            --color-accent-amber: #f59e0b;
            --color-accent-green: #10b981;
            --color-accent-red: #ef4444;
            --color-rating: #fbbf24;
            
            /* Borders */
            --color-border: #e2e8f0;
            --color-border-hover: #cbd5e1;
            
            /* Shadows */
            --shadow-card: 0 10px 25px -5px rgba(0, 0, 0, 0.05);
            --shadow-card-hover: 0 20px 40px -10px rgba(0, 176, 252, 0.15);
            --shadow-modal: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
            --shadow-nav: 0 1px 3px rgba(0, 0, 0, 0.05);
            
            /* Effects */
            --backdrop-blur: blur(8px);
            --transition-smooth: 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            --transition-fast: 0.2s ease;
        }

        /* Dark Theme Variables */
        .dark-theme {
            /* Primary Accents */
            --color-primary: #76d5fe;
            --color-primary-light: #b1e7ff;
            --color-primary-dark: #0286df;
            
            /* Background & Cards */
            --color-bg-main: #0f172a;
            --color-bg-card: #1e293b;
            --color-bg-hover: #334155;
            --color-bg-modal: #1e293b;
            
            /* Text Colors */
            --color-text-primary: #f1f5f9;
            --color-text-secondary: #cbd5e1;
            --color-text-muted: #94a3b8;
            
            /* Accents & UI */
            --color-accent-purple: #a78bfa;
            --color-accent-amber: #fbbf24;
            --color-accent-green: #34d399;
            --color-accent-red: #f87171;
            --color-rating: #fbbf24;
            
            /* Borders */
            --color-border: #334155;
            --color-border-hover: #475569;
            
            /* Shadows */
            --shadow-card: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
            --shadow-card-hover: 0 20px 40px -10px rgba(118, 213, 254, 0.2);
            --shadow-modal: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            --shadow-nav: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            transition: background-color 0.5s ease;
        }

        body {
            font-family: 'Outfit', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--color-bg-main);
            color: var(--color-text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        /* Theme Transition Overlay */
        .theme-transition {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--color-primary);
            z-index: 9998;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s ease;
        }

        .theme-transition.active {
            opacity: 0.1;
        }

        /* Loading Screen */
        #initialLoading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--color-bg-main);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.6s ease, visibility 0.6s ease, background-color 0.5s ease;
        }

        #initialLoading.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loading-content {
            text-align: center;
            animation: fadeIn 0.8s ease;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 3px solid rgba(203, 213, 225, 0.3);
            border-top-color: var(--color-primary);
            border-radius: 50%;
            margin: 0 auto 1.5rem;
            animation: spin 1s ease-in-out infinite;
            transition: border-color 0.5s ease;
        }

        .loading-text {
            color: var(--color-text-secondary);
            font-size: 1rem;
            font-weight: 500;
            letter-spacing: 0.5px;
            transition: color 0.5s ease;
        }

        /* Main App */
        .app-container {
            min-height: 100vh;
            opacity: 0;
            animation: fadeIn 0.5s ease 0.3s forwards;
        }

        /* Navigation */
        .main-nav {
            position: sticky;
            top: 0;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: var(--backdrop-blur);
            border-bottom: 1px solid var(--color-border);
            z-index: 1000;
            padding: 1rem 2rem;
            box-shadow: var(--shadow-nav);
            transition: all 0.5s ease;
        }

        .dark-theme .main-nav {
            background: rgba(30, 41, 59, 0.9);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 2rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
            transition: transform var(--transition-fast);
        }

        .logo:hover {
            transform: translateX(-2px);
        }

        .logo-icon {
            font-size: 1.75rem;
            color: var(--color-primary);
            transition: color 0.5s ease;
        }

        .logo-text {
            font-family: 'Poppins', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--color-text-primary);
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-accent-purple) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            transition: background 0.5s ease;
        }

        .search-container {
            flex: 1;
            max-width: 600px;
            position: relative;
        }

        .search-box {
            position: relative;
        }

        .search-icon {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--color-text-muted);
            z-index: 2;
            transition: color 0.5s ease;
        }

        .search-input {
            width: 100%;
            padding: 14px 20px 14px 48px;
            background: var(--color-bg-card);
            border: 2px solid var(--color-border);
            border-radius: 12px;
            color: var(--color-text-primary);
            font-size: 1rem;
            font-weight: 500;
            transition: all var(--transition-smooth);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(0, 176, 252, 0.2);
        }

        .dark-theme .search-input:focus {
            box-shadow: 0 0 0 3px rgba(118, 213, 254, 0.2);
        }

        .nav-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        /* Theme Toggle Button */
        .theme-toggle {
            position: relative;
            width: 60px;
            height: 32px;
            background: var(--color-border);
            border-radius: 50px;
            border: none;
            cursor: pointer;
            padding: 4px;
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            overflow: hidden;
        }

        .theme-toggle:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(0, 176, 252, 0.3);
        }

        .theme-toggle:active {
            transform: scale(0.95);
        }

        .theme-toggle::before {
            content: '';
            position: absolute;
            top: 4px;
            left: 4px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            z-index: 2;
        }

        .dark-theme .theme-toggle::before {
            transform: translateX(28px);
            background: #fbbf24;
        }

        .theme-toggle-sun,
        .theme-toggle-moon {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-size: 14px;
            transition: all 0.5s ease;
            color: var(--color-text-primary);
        }

        .theme-toggle-sun {
            left: 8px;
            opacity: 1;
        }

        .theme-toggle-moon {
            right: 8px;
            opacity: 0;
            color: #1e293b;
        }

        .dark-theme .theme-toggle-sun {
            opacity: 0;
        }

        .dark-theme .theme-toggle-moon {
            opacity: 1;
        }

        .add-game-btn {
            padding: 12px 24px;
            background: var(--color-primary);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-smooth);
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .add-game-btn:hover {
            background: var(--color-primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 14px 0 rgba(0, 176, 252, 0.25);
        }

        /* Hero Section */
        .hero-section {
            padding: 100px 2rem 60px;
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
        }

        .hero-title {
            font-family: 'Poppins', sans-serif;
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            color: var(--color-text-primary);
            line-height: 1.2;
            transition: color 0.5s ease;
        }

        .hero-subtitle {
            font-size: 1.2rem;
            color: var(--color-text-secondary);
            max-width: 600px;
            margin: 0 auto;
            font-weight: 400;
            transition: color 0.5s ease;
        }

        /* Filters Section */
        .filters-section {
            max-width: 1400px;
            margin: 0 auto 2rem;
            padding: 0 2rem;
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .filter-label {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--color-text-secondary);
            transition: color 0.5s ease;
        }

        .filter-select {
            padding: 12px 20px;
            background: var(--color-bg-card);
            border: 2px solid var(--color-border);
            border-radius: 10px;
            color: var(--color-text-primary);
            font-size: 0.95rem;
            font-weight: 500;
            transition: all var(--transition-fast);
            width: 100%;
            cursor: pointer;
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--color-primary);
        }

        /* Games Grid */
        .games-section {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem 4rem;
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
        }

        .game-card {
            background: var(--color-bg-card);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: var(--shadow-card);
            transition: all var(--transition-smooth);
            position: relative;
            cursor: pointer;
            border: 1px solid var(--color-border);
            animation: cardAppear 0.6s ease;
            animation-fill-mode: both;
        }

        @keyframes cardAppear {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .game-card:hover {
            transform: translateY(-8px) scale(1.02);
            border-color: var(--color-primary);
            box-shadow: var(--shadow-card-hover);
        }

        .game-cover {
            position: relative;
            width: 100%;
            height: 280px;
            overflow: hidden;
        }

        .game-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform var(--transition-smooth);
        }

        .game-card:hover .game-cover img {
            transform: scale(1.05);
        }

        .cover-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.4) 0%, transparent 40%);
            display: flex;
            align-items: flex-end;
            padding: 1.5rem;
        }

        .game-rating-badge {
            background: rgba(255, 255, 255, 0.95);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            color: var(--color-rating);
            display: flex;
            align-items: center;
            gap: 6px;
            backdrop-filter: var(--backdrop-blur);
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        .dark-theme .game-rating-badge {
            background: rgba(30, 41, 59, 0.95);
        }

        /* Edit/Delete buttons on game card */
        .game-actions {
            position: absolute;
            top: 1rem;
            right: 1rem;
            display: flex;
            gap: 0.5rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 2;
        }

        .game-card:hover .game-actions {
            opacity: 1;
        }

        .game-action-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.95);
            color: var(--color-text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        .dark-theme .game-action-btn {
            background: rgba(30, 41, 59, 0.95);
            color: var(--color-text-secondary);
        }

        .game-action-btn:hover {
            transform: scale(1.1);
            background: var(--color-primary);
            color: white;
        }

        .game-action-btn.delete:hover {
            background: var(--color-accent-red);
        }

        .game-info {
            padding: 1.5rem;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .game-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--color-text-primary);
            line-height: 1.3;
            transition: color 0.5s ease;
        }

        .game-creator {
            font-size: 0.8rem;
            color: var(--color-text-muted);
            margin-top: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .game-genre {
            display: inline-block;
            padding: 6px 12px;
            background: rgba(118, 213, 254, 0.1);
            color: var(--color-primary-dark);
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 1rem;
            transition: all 0.5s ease;
        }

        .dark-theme .game-genre {
            background: rgba(118, 213, 254, 0.2);
            color: var(--color-primary-light);
        }

        .game-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--color-text-muted);
            font-size: 0.9rem;
            transition: color 0.5s ease;
        }

        .game-date {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .game-rating-stats {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.85rem;
        }

        .game-rating-stars {
            color: var(--color-rating);
            font-size: 0.9rem;
            letter-spacing: 1px;
        }

        .game-rating-count {
            color: var(--color-text-muted);
            font-size: 0.8rem;
        }

        /* Game Details Modal */
        .game-details-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2001;
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition-smooth);
            padding: 1rem;
        }

        .game-details-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .game-details-content {
            background: var(--color-bg-modal);
            border-radius: 20px;
            width: 100%;
            max-width: 1000px;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(30px) scale(0.95);
            transition: transform var(--transition-smooth), background-color 0.5s ease;
            box-shadow: var(--shadow-modal);
            border: 1px solid var(--color-border);
            display: flex;
            flex-direction: column;
        }

        .game-details-modal.active .game-details-content {
            transform: translateY(0) scale(1);
        }

        .game-details-header {
            padding: 2rem 2rem 1rem;
            border-bottom: 1px solid var(--color-border);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            position: relative;
        }

        .game-details-actions {
            position: absolute;
            top: 2rem;
            right: 4rem;
            display: flex;
            gap: 0.5rem;
        }

        .game-details-action-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: var(--color-bg-hover);
            color: var(--color-text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        .game-details-action-btn:hover {
            transform: scale(1.1);
            background: var(--color-primary);
            color: white;
        }

        .game-details-action-btn.delete:hover {
            background: var(--color-accent-red);
        }

        .game-details-title {
            font-size: 2rem;
            font-weight: 800;
            color: var(--color-text-primary);
            line-height: 1.2;
            margin-right: 2rem;
        }

        .game-details-close {
            background: none;
            border: none;
            color: var(--color-text-muted);
            font-size: 2rem;
            cursor: pointer;
            padding: 8px;
            transition: color var(--transition-fast);
            flex-shrink: 0;
        }

        .game-details-close:hover {
            color: var(--color-text-primary);
        }

        .game-details-body {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            padding: 2rem;
        }

        @media (max-width: 768px) {
            .game-details-body {
                grid-template-columns: 1fr;
            }
            
            .game-details-actions {
                top: 1.5rem;
                right: 3.5rem;
            }
        }

        .game-details-media {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .youtube-player {
            width: 100%;
            aspect-ratio: 16/9;
            border-radius: 12px;
            overflow: hidden;
            background: #000;
        }

        .youtube-player iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .game-details-cover {
            width: 100%;
            height: 200px;
            border-radius: 12px;
            overflow: hidden;
        }

        .game-details-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .game-details-info {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .game-details-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: center;
        }

        .game-details-genre {
            padding: 8px 16px;
            background: rgba(118, 213, 254, 0.1);
            color: var(--color-primary-dark);
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.5s ease;
        }

        .dark-theme .game-details-genre {
            background: rgba(118, 213, 254, 0.2);
            color: var(--color-primary-light);
        }

        .game-details-date {
            display: flex;
            align-items: center;
            gap: 6px;
            color: var(--color-text-secondary);
            font-size: 0.9rem;
        }

        .game-details-rating {
            background: rgba(251, 191, 36, 0.1);
            padding: 8px 16px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--color-rating);
            font-weight: 600;
        }

        .game-details-rating-stars {
            font-size: 1.2rem;
            letter-spacing: 2px;
        }

        .game-details-description {
            color: var(--color-text-secondary);
            line-height: 1.7;
            font-size: 1.05rem;
        }

        .game-details-description p {
            margin-bottom: 1rem;
        }

        /* Requirements Section */
        .requirements-section {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--color-border);
        }

        .requirements-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--color-text-primary);
        }

        .requirements-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .requirement-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--color-text-secondary);
        }

        .requirement-value {
            font-weight: 600;
            color: var(--color-text-primary);
        }

        .rate-game-section {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--color-border);
        }

        .rate-game-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--color-text-primary);
        }

        .rating-stars-input {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .rating-star {
            font-size: 1.8rem;
            color: var(--color-border);
            cursor: pointer;
            transition: color 0.2s ease, transform 0.2s ease;
        }

        .rating-star:hover {
            transform: scale(1.2);
        }

        .rating-star.active {
            color: var(--color-rating);
        }

        .submit-rating-btn {
            padding: 8px 16px;
            background: var(--color-accent-green);
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .submit-rating-btn:hover:not(:disabled) {
            background: #0da271;
            transform: translateY(-1px);
        }

        .submit-rating-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Add/Edit Game Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition-smooth);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--color-bg-modal);
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(20px) scale(0.95);
            transition: transform var(--transition-smooth), background-color 0.5s ease;
            box-shadow: var(--shadow-modal);
            border: 1px solid var(--color-border);
        }

        .modal-overlay.active .modal-content {
            transform: translateY(0) scale(1);
        }

        .modal-header {
            padding: 1.5rem 1.5rem 1rem;
            border-bottom: 1px solid var(--color-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--color-text-primary);
            transition: color 0.5s ease;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--color-text-muted);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 8px;
            transition: color var(--transition-fast);
        }

        .modal-close:hover {
            color: var(--color-text-primary);
        }

        .modal-body {
            padding: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--color-text-secondary);
            transition: color 0.5s ease;
        }

        .form-input {
            width: 100%;
            padding: 14px;
            background: var(--color-bg-card);
            border: 2px solid var(--color-border);
            border-radius: 10px;
            color: var(--color-text-primary);
            font-size: 1rem;
            transition: all var(--transition-fast);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(118, 213, 254, 0.2);
        }

        /* Requirements Grid in Add Game Modal */
        .requirements-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--color-border);
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-smooth);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: var(--color-primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 14px 0 rgba(0, 176, 252, 0.25);
        }

        .btn-secondary {
            background: var(--color-bg-hover);
            color: var(--color-text-secondary);
            border: 2px solid var(--color-border);
        }

        .btn-secondary:hover {
            background: var(--color-border);
        }

        .btn-danger {
            background: var(--color-accent-red);
            color: white;
        }

        .btn-danger:hover:not(:disabled) {
            background: #dc2626;
            transform: translateY(-2px);
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            padding: 1rem 1.5rem;
            background: var(--color-bg-modal);
            border-left: 4px solid var(--color-primary);
            border-radius: 10px;
            box-shadow: var(--shadow-modal);
            transform: translateX(150%);
            transition: transform var(--transition-smooth), background-color 0.5s ease;
            z-index: 3000;
            min-width: 300px;
            border: 1px solid var(--color-border);
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.error {
            border-left-color: var(--color-accent-red);
        }

        .toast.success {
            border-left-color: var(--color-accent-green);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            grid-column: 1 / -1;
            background: var(--color-bg-card);
            border-radius: 16px;
            border: 2px dashed var(--color-border);
            transition: all 0.5s ease;
        }

        .empty-icon {
            font-size: 3rem;
            color: var(--color-border);
            margin-bottom: 1.5rem;
            transition: color 0.5s ease;
        }

        .empty-title {
            font-size: 1.5rem;
            color: var(--color-text-secondary);
            margin-bottom: 0.5rem;
            transition: color 0.5s ease;
        }

        .empty-subtitle {
            color: var(--color-text-muted);
            transition: color 0.5s ease;
        }

        /* Load More Button */
        .load-more {
            text-align: center;
            margin-top: 3rem;
        }

        .load-more-btn {
            padding: 12px 24px;
            background: var(--color-bg-card);
            color: var(--color-primary);
            border: 2px solid var(--color-border);
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-smooth);
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .load-more-btn:hover:not(:disabled) {
            background: var(--color-bg-hover);
            border-color: var(--color-primary);
        }

        /* Footer */
        .main-footer {
            background: var(--color-bg-card);
            border-top: 1px solid var(--color-border);
            padding: 2rem;
            text-align: center;
            transition: all 0.5s ease;
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        /* Add to your CSS - around line 600 would be good */
.donate-btn {
    padding: 12px 24px;
    background: linear-gradient(135deg, #FF6B6B 0%, #FF8E8E 100%);
    color: white;
    border: none;
    border-radius: 10px;
    font-size: 0.95rem;
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition-smooth);
    display: flex;
    align-items: center;
    gap: 8px;
    white-space: nowrap;
}

.donate-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 14px 0 rgba(255, 107, 107, 0.25);
}

.donate-btn:active {
    transform: translateY(0);
}

/* Optional: Add a supporters count badge */
.donate-btn.with-badge {
    position: relative;
}

.donation-badge {
    position: absolute;
    top: -8px;
    right: -8px;
    background: var(--color-accent-green);
    color: white;
    font-size: 0.7rem;
    padding: 2px 6px;
    border-radius: 10px;
    font-weight: 700;
}

        .footer-link {
            color: var(--color-text-secondary);
            text-decoration: none;
            font-weight: 500;
            transition: color var(--transition-fast);
        }

        .footer-link:hover {
            color: var(--color-primary);
        }

        .footer-copyright {
            color: var(--color-text-muted);
            font-size: 0.9rem;
            transition: color 0.5s ease;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                gap: 1rem;
            }
            
            .search-container {
                width: 100%;
                max-width: 100%;
            }
            
            .hero-title {
                font-size: 2.5rem;
            }
            
            .games-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .filters-grid {
                grid-template-columns: 1fr;
            }
            
            .requirements-list {
                grid-template-columns: 1fr;
            }
            
            .requirements-grid {
                grid-template-columns: 1fr;
            }
            
            .game-details-title {
                font-size: 1.5rem;
            }
        }

        /* Lazy Loading */
        .lazy-image {
            background: linear-gradient(90deg, var(--color-bg-hover) 25%, var(--color-border) 50%, var(--color-bg-hover) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            transition: background-color 0.5s ease;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
    </style>
</head>
<body>
    <!-- Theme Transition Overlay -->
    <div class="theme-transition"></div>

    <!-- Loading Screen -->
    <div id="initialLoading">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text">Loading Choose a Game</div>
        </div>
    </div>

    <!-- Main App -->
    <div class="app-container">
        <!-- About Modal -->
<div class="legal-modal" id="aboutModal">
    <div class="legal-modal-content">
        <div class="legal-modal-header">
            <h2 class="legal-modal-title">About Choose a Game</h2>
            <button class="legal-modal-close" data-modal="about">&times;</button>
        </div>
        <div class="legal-modal-body">
            <div class="legal-modal-section">
                <h3>The Gamer's Database</h3>
                <p>Choose a Game is an open-source gaming database built <strong>by gamers, for gamers</strong>. We believe in the power of community-driven information to help fellow gamers make better choices about what to play next.</p>
                
                <p>This platform is a shared space where gamers can:</p>
                <ul>
                    <li><strong>Share game information</strong> with the community</li>
                    <li><strong>Rate and review games</strong> to help others</li>
                    <li><strong>Filter games by system requirements</strong> to find what works on their setup</li>
                    <li><strong>Discover new adventures</strong> through community recommendations</li>
                </ul>
            </div>
            
            <div class="legal-modal-section">
                <h3>How It Works</h3>
                <p>Every piece of information here comes from <strong>fellow gamers</strong>. Anyone can add games, rate them, and help build this community resource. All uploaded information is visible to all users - we believe in transparency and shared knowledge.</p>
            </div>
            
            <div class="legal-modal-section">
                <h3>Our Philosophy</h3>
                <p>We're not a corporate platform. We're gamers helping gamers. The data belongs to the community, and everyone contributes to making it better.</p>
                <p>Remember: <strong>This is a public platform</strong>. Anything you upload can be seen by others, so please be respectful and accurate with your contributions.</p>
            </div>
            
            <div class="legal-modal-section">
                <h3>Join the Community</h3>
                <p>Help fellow gamers by adding games you love, rating ones you've played, and keeping information updated. Together, we build a better gaming resource for everyone.</p>
            </div>
        </div>
    </div>
</div>

<!-- Privacy Modal -->
<div class="legal-modal" id="privacyModal">
    <div class="legal-modal-content">
        <div class="legal-modal-header">
            <h2 class="legal-modal-title">Privacy & Data</h2>
            <button class="legal-modal-close" data-modal="privacy">&times;</button>
        </div>
        <div class="legal-modal-body">
            <div class="legal-modal-section">
                <h3>Simple Privacy Facts</h3>
                <p>We keep things straightforward:</p>
                <ul>
                    <li><strong>Public Platform:</strong> All game information, ratings, and reviews you add are visible to everyone</li>
                    <li><strong>Anonymous Contributions:</strong> You don't need to create an account - contributions are tied to your browser</li>
                    <li><strong>No Personal Data:</strong> We don't collect email addresses, names, or personal information</li>
                    <li><strong>Game Info Only:</strong> We only store game-related information you choose to share</li>
                </ul>
            </div>
            
            <div class="legal-modal-section">
                <h3>What Happens to Your Data</h3>
                <p><strong>Important:</strong> Any game information you add becomes part of our community database and can be seen by all users.</p>
                <p>You can edit or delete your own contributions at any time. Community ratings help everyone find the best games to play.</p>
            </div>
            
            <div class="legal-modal-section">
                <h3>Your Responsibility</h3>
                <p>Since this is a community-driven platform, it's every user's responsibility to:</p>
                <ul>
                    <li>Only upload information you have the right to share</li>
                    <li>Keep content appropriate and respectful</li>
                    <li>Report incorrect or problematic content</li>
                    <li>Help maintain the quality of our shared resource</li>
                </ul>
            </div>
            
            <div class="legal-modal-section">
                <h3>Third-Party Content</h3>
                <p>Game trailers are embedded from YouTube. When you watch videos here, YouTube's own policies apply for their content.</p>
            </div>
        </div>
    </div>
</div>

<!-- Terms Modal -->
<div class="legal-modal" id="termsModal">
    <div class="legal-modal-content">
        <div class="legal-modal-header">
            <h2 class="legal-modal-title">Terms of Use</h2>
            <button class="legal-modal-close" data-modal="terms">&times;</button>
        </div>
        <div class="legal-modal-body">
            <div class="legal-modal-section">
                <h3>Community Rules</h3>
                <p>By using Choose a Game, you agree to these simple rules:</p>
                <ul>
                    <li><strong>Be Helpful:</strong> Contribute accurate information that helps fellow gamers</li>
                    <li><strong>Be Respectful:</strong> This is a shared space for all gamers</li>
                    <li><strong>Be Responsible:</strong> You're accountable for what you upload</li>
                    <li><strong>Game Info Only:</strong> Keep content focused on gaming information</li>
                </ul>
            </div>
            
            <div class="legal-modal-section">
                <h3>⚠️ Important Copyright Notice</h3>
                <p><strong>DISCLAIMER:</strong> Choose a Game is a community database for sharing gaming information. We do not host, distribute, or own any of the games listed here.</p>
                
                <p><strong>Game Content:</strong> All game titles, characters, artwork, and related content are property of their respective owners. We only provide information about games, not the games themselves.</p>
                
                <p><strong>Trailers & Images:</strong> We use YouTube's embed feature for trailers and publicly available images for game covers. We don't host copyrighted material directly.</p>
                
                <p><strong>Your Responsibility:</strong> When adding content, ensure you have the right to share it. Don't upload copyrighted material you don't have permission to use.</p>
            </div>
            
            <div class="legal-modal-section">
                <h3>Content Guidelines</h3>
                <p>Do NOT upload:</p>
                <ul>
                    <li>Pirated or illegal content</li>
                    <li>Copyrighted material you don't own or have permission to share</li>
                    <li>Offensive, harmful, or inappropriate content</li>
                    <li>Personal information of yourself or others</li>
                    <li>Commercial promotions or spam</li>
                </ul>
                
                <p>We reserve the right to remove any content that violates these guidelines.</p>
            </div>
            
            <div class="legal-modal-section">
                <h3>Community Spirit</h3>
                <p>This platform exists to help gamers. We rely on the community to keep it clean, accurate, and useful for everyone. If you see incorrect information, help by adding better information or reporting issues.</p>
                
                <p>Remember: Everything you add is public and helps other gamers make better choices.</p>
            </div>
            
            <div class="legal-modal-section">
                <h3>Limitations</h3>
                <p>This service is provided as-is by gamers for gamers. We make no guarantees about uptime, data permanence, or accuracy of user-submitted content. Always verify information before making decisions.</p>
            </div>
        </div>
    </div>
</div>

<!-- Contact Modal -->
<div class="legal-modal" id="contactModal">
    <div class="legal-modal-content">
        <div class="legal-modal-header">
            <h2 class="legal-modal-title">Support & Contact</h2>
            <button class="legal-modal-close" data-modal="contact">&times;</button>
        </div>
        <div class="legal-modal-body">
            <div class="legal-modal-section">
                <h3>Need Help?</h3>
                <p>This is a community project. While there's no formal support team, here's how you can get help or contribute:</p>
            </div>
            
            <div class="legal-modal-section">
                <h3>Getting Started</h3>
                <div class="contact-info">
                    <div class="contact-item">
                        <i class="fas fa-gamepad"></i>
                        <div>
                            <strong>Add Games:</strong><br>
                            <span>Click "Add Game" in the top right to contribute</span>
                        </div>
                    </div>
                    
                    <div class="contact-item">
                        <i class="fas fa-star"></i>
                        <div>
                            <strong>Rate Games:</strong><br>
                            <span>Click any game to view details and add your rating</span>
                        </div>
                    </div>
                    
                    <div class="contact-item">
                        <i class="fas fa-filter"></i>
                        <div>
                            <strong>Find Games:</strong><br>
                            <span>Use filters to find games that work on your system</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="legal-modal-section">
                <h3>Common Issues</h3>
                <p><strong>Can't see your added game?</strong> Try refreshing the page or checking filters.</p>
                <p><strong>Wrong information on a game?</strong> Edit it if you added it, or add correct information as a new entry.</p>
                <p><strong>YouTube trailer not working?</strong> The video may have been removed - you can update the YouTube ID.</p>
            </div>
            
            <div class="legal-modal-section">
                <h3>Reporting Problems</h3>
                <p>If you encounter:</p>
                <ul>
                    <li>Inappropriate content</li>
                    <li>Copyright violations</li>
                    <li>Serious platform issues</li>
                </ul>
                <p>Please note: This is a community project. While we'll do our best, response times aren't guaranteed.</p>
            </div>
            
            <div class="legal-modal-section">
                <h3>Contribute to the Project</h3>
                <p>This is an open-source project. If you're a developer or designer, consider contributing to make it better for everyone.</p>
            </div>
            
            <div class="legal-modal-section">
                <h3>Community First</h3>
                <p>Remember: This platform works because gamers help each other. The best way to get help is to be part of the community that helps others.</p>
            </div>
        </div>
    </div>
</div>
        <!-- Navigation -->
        <nav class="main-nav">
            <div class="nav-container">
                <a href="#" class="logo">
                    <i class="fas fa-gamepad logo-icon"></i>
                    <span class="logo-text">Choose a Game</span>
                </a>
                
                <div class="search-container">
                    <div class="search-box">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" class="search-input" placeholder="Search games...">
                    </div>
                </div>
                
                <div class="nav-actions">
                    <!-- Add inside .nav-actions div (around line 300 in your HTML) -->
<button class="donate-btn" id="donateButton">
    <i class="fas fa-heart"></i>
    Support Us (₹10)
</button>
                    <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode">
                        <i class="fas fa-sun theme-toggle-sun"></i>
                        <i class="fas fa-moon theme-toggle-moon"></i>
                    </button>
                    
                    <button class="add-game-btn" id="openAddGameModal">
                        <i class="fas fa-plus"></i>
                        Add Game
                    </button>
                </div>
            </div>
        </nav>

        <!-- Hero Section -->
        <section class="hero-section">
            <h1 class="hero-title">Discover Your Next Adventure</h1>
            <p class="hero-subtitle">Browse, rate, and organize your gaming collection. Find the perfect game to play next based on your system specs.</p>
        </section>

        <!-- Filters -->
        <section class="filters-section">
            <div class="filters-grid">
                <div class="filter-group">
                    <label class="filter-label">Sort By</label>
                    <select class="filter-select" id="sortSelect">
                        <option value="date">Newest First</option>
                        <option value="rating">Highest Rated</option>
                        <option value="name">A to Z</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Genre</label>
                    <select class="filter-select" id="genreFilter">
                        <option value="">All Genres</option>
                        <option value="Action">Action</option>
                        <option value="Adventure">Adventure</option>
                        <option value="RPG">RPG</option>
                        <option value="FPS">FPS</option>
                        <option value="Strategy">Strategy</option>
                        <option value="Sports">Sports</option>
                        <option value="Simulation">Simulation</option>
                        <option value="Horror">Horror</option>
                        <option value="Racing">Racing</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Minimum Rating</label>
                    <select class="filter-select" id="ratingFilter">
                        <option value="">All Ratings</option>
                        <option value="4.5">★★★★½ (4.5+)</option>
                        <option value="4">★★★★☆ (4+)</option>
                        <option value="3.5">★★★½☆ (3.5+)</option>
                        <option value="3">★★★☆☆ (3+)</option>
                        <option value="2">★★☆☆☆ (2+)</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Graphics Type</label>
                    <select class="filter-select" id="graphicsFilter">
                        <option value="">Any Graphics</option>
                        <option value="Integrated">Integrated GPU</option>
                        <option value="Dedicated Low">Dedicated GPU (Low)</option>
                        <option value="Dedicated Mid">Dedicated GPU (Mid)</option>
                        <option value="Dedicated High">Dedicated GPU (High)</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Minimum RAM (GB)</label>
                    <select class="filter-select" id="ramFilter">
                        <option value="">Any RAM</option>
                        <option value="4">4 GB</option>
                        <option value="8">8 GB</option>
                        <option value="16">16 GB</option>
                        <option value="32">32 GB</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Storage Space</label>
                    <select class="filter-select" id="storageFilter">
                        <option value="">Any Storage</option>
                        <option value="10">10 GB</option>
                        <option value="25">25 GB</option>
                        <option value="50">50 GB</option>
                        <option value="100">100 GB</option>
                        <option value="150">150 GB</option>
                    </select>
                </div>
            </div>
        </section>

        <!-- Games Grid -->
        <section class="games-section">
            <div class="games-grid" id="gamesGrid">
                <!-- Games will be loaded here -->
                <div class="empty-state" id="emptyState">
                    <i class="fas fa-gamepad empty-icon"></i>
                    <h3 class="empty-title">No Games Yet</h3>
                    <p class="empty-subtitle">Start by adding your first game to the collection!</p>
                </div>
            </div>
            
            <div class="load-more" id="loadMoreContainer" style="display: none;">
                <button class="load-more-btn" id="loadMoreBtn">
                    <i class="fas fa-chevron-down"></i>
                    Load More
                </button>
            </div>
        </section>

        <!-- Footer -->
        <footer class="main-footer">
            <div class="footer-content">
                <div class="footer-links">
    <a href="#" class="footer-link" data-modal="about">About</a>
    <a href="#" class="footer-link" data-modal="privacy">Privacy</a>
    <a href="#" class="footer-link" data-modal="terms">Terms</a>
    <a href="#" class="footer-link" data-modal="contact">Contact</a>
</div>
                <p class="footer-copyright">© 2025 Choose a Game. All rights reserved.</p>
            </div>
        </footer>

        <!-- Game Details Modal -->
        <div class="game-details-modal" id="gameDetailsModal">
            <div class="game-details-content">
                <div class="game-details-header">
                    <div class="game-details-actions" id="gameDetailsActions">
                        <!-- Edit/Delete buttons will be added here -->
                    </div>
                    <h2 class="game-details-title" id="gameDetailsTitle">Game Title</h2>
                    <button class="game-details-close" id="closeGameDetails">&times;</button>
                </div>
                <div class="game-details-body">
                    <div class="game-details-media">
                        <div class="youtube-player" id="youtubePlayer">
                            <!-- YouTube iframe will be inserted here -->
                        </div>
                        <div class="game-details-cover">
                            <img id="gameDetailsImage" src="" alt="">
                        </div>
                    </div>
                    <div class="game-details-info">
                        <div class="game-details-meta">
                            <span class="game-details-genre" id="gameDetailsGenre">Genre</span>
                            <span class="game-details-date" id="gameDetailsDate">
                                <i class="far fa-calendar"></i>
                                <span id="gameDetailsDateText"></span>
                            </span>
                            <div class="game-details-rating" id="gameDetailsRating">
                                <div class="game-details-rating-stars" id="gameDetailsRatingStars"></div>
                                <span id="gameDetailsRatingValue"></span>
                                <span class="game-rating-count" id="gameDetailsRatingCount">(0 ratings)</span>
                            </div>
                        </div>
                        
                        <div class="game-details-description" id="gameDetailsDescription">
                            <!-- Game description will be inserted here -->
                        </div>
                        
                        <!-- System Requirements Section -->
                        <div class="requirements-section">
                            <h3 class="requirements-title">System Requirements</h3>
                            <div class="requirements-list" id="requirementsList">
                                <!-- Requirements will be inserted here -->
                            </div>
                        </div>
                        
                        <div class="rate-game-section">
                            <h3 class="rate-game-title">Rate this Game</h3>
                            <div id="ratingInfo">
                                <p style="color: var(--color-text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">
                                    <i class="fas fa-info-circle"></i>
                                    Each user can only rate once. You can update your rating later.
                                </p>
                            </div>
                            <div class="rating-stars-input" id="ratingStarsInput">
                                <span class="rating-star" data-value="1">☆</span>
                                <span class="rating-star" data-value="2">☆</span>
                                <span class="rating-star" data-value="3">☆</span>
                                <span class="rating-star" data-value="4">☆</span>
                                <span class="rating-star" data-value="5">☆</span>
                            </div>
                            <div id="userRatingInfo" style="margin-bottom: 1rem;">
                                <!-- User's existing rating will be shown here -->
                            </div>
                            <button class="submit-rating-btn" id="submitRatingBtn" disabled>
                                Submit Rating
                            </button>
                            <button class="submit-rating-btn" id="removeRatingBtn" style="background: var(--color-accent-red); display: none; margin-top: 0.5rem;">
                                <i class="fas fa-trash"></i> Remove My Rating
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add/Edit Game Modal -->
        <div class="modal-overlay" id="addGameModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title" id="modalTitle">Add New Game</h2>
                    <button class="modal-close" id="closeModal">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="gameForm">
                        <input type="hidden" id="editGameId" value="">
                        
                        <div class="form-group">
                            <label class="form-label">Game Title *</label>
                            <input type="text" class="form-input" id="gameTitle" required placeholder="Enter game title">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Genre *</label>
                            <select class="form-input" id="gameGenre" required>
                                <option value="">Select Genre</option>
                                <option value="Action">Action</option>
                                <option value="Adventure">Adventure</option>
                                <option value="RPG">RPG</option>
                                <option value="FPS">FPS</option>
                                <option value="Strategy">Strategy</option>
                                <option value="Sports">Sports</option>
                                <option value="Simulation">Simulation</option>
                                <option value="Horror">Horror</option>
                                <option value="Racing">Racing</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Release Date *</label>
                            <input type="date" class="form-input" id="gameDate" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Description *</label>
                            <textarea class="form-input" id="gameDescription" required rows="4" placeholder="Enter game description..."></textarea>
                        </div>
                        
                        <!-- System Requirements -->
                        <div class="requirements-grid">
                            <div class="form-group">
                                <label class="form-label">Graphics Type</label>
                                <select class="form-input" id="gameGraphics">
                                    <option value="">Select Graphics Type</option>
                                    <option value="Integrated">Integrated GPU</option>
                                    <option value="Dedicated Low">Dedicated GPU (Low)</option>
                                    <option value="Dedicated Mid">Dedicated GPU (Mid)</option>
                                    <option value="Dedicated High">Dedicated GPU (High)</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Minimum RAM (GB)</label>
                                <input type="number" class="form-input" id="gameRam" min="2" max="128" placeholder="e.g., 8">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Storage Space (GB)</label>
                                <input type="number" class="form-input" id="gameStorage" min="1" max="500" placeholder="e.g., 50">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Processor Level</label>
                                <select class="form-input" id="gameProcessor">
                                    <option value="">Select Processor</option>
                                    <option value="Low">Low-end</option>
                                    <option value="Mid">Mid-range</option>
                                    <option value="High">High-end</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">YouTube Video URL or ID *</label>
                            <input type="text" class="form-input" id="gameYoutubeId" required
                                   placeholder="Enter YouTube URL or ID (e.g., https://youtu.be/dQw4w9WgXcQ)">
                            <small style="color: var(--color-text-muted); font-size: 0.85rem;">
                                Paste the full YouTube URL or just the video ID. Click "Share" on YouTube to copy the link.
                            </small>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Cover Image URL</label>
                            <input type="url" class="form-input" id="gameImage" 
                                   placeholder="https://example.com/game-cover.jpg">
                            <small style="color: var(--color-text-muted); font-size: 0.85rem;">
                                Tip: Right-click on Google Images → "Copy image address"
                            </small>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" id="cancelBtn">
                                Cancel
                            </button>
                            <button type="submit" class="btn btn-primary" id="submitBtn">
                                <i class="fas fa-plus"></i>
                                Add Game
                            </button>
                            <button type="button" class="btn btn-danger" id="deleteGameBtn" style="display: none;">
                                <i class="fas fa-trash"></i>
                                Delete Game
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Toast Notification -->
        <div class="toast" id="toast"></div>
    </div>

    <script>
        // Supabase Configuration - YOUR CREDENTIALS
        const SUPABASE_URL = 'https://jqtpssafhjgvfjgebkuf.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpxdHBzc2FmaGpndmZqZ2Via3VmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUyNDA3NDgsImV4cCI6MjA4MDgxNjc0OH0.AhtHlWU0dTzpfarZNG0QSAyRsnHYoAOQCovQf5thXkk';
        
        // Initialize Supabase
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
        // DOM Elements
        const initialLoading = document.getElementById('initialLoading');
        const gamesGrid = document.getElementById('gamesGrid');
        const emptyState = document.getElementById('emptyState');
        const searchInput = document.querySelector('.search-input');
        const addGameModal = document.getElementById('addGameModal');
        const gameDetailsModal = document.getElementById('gameDetailsModal');
        const gameForm = document.getElementById('gameForm');
        const toast = document.getElementById('toast');
        const themeToggle = document.getElementById('themeToggle');
        const themeTransition = document.querySelector('.theme-transition');
        
        // Theme Management
        const THEME_KEY = 'choose-a-game-theme';
        const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
        
        // User Management
        const USER_ID_KEY = 'choose-a-game-user-id';
        let userId = null;
        
        // Initialize user ID
        function initUserId() {
            userId = localStorage.getItem(USER_ID_KEY);
            if (!userId) {
                userId = 'user_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now();
                localStorage.setItem(USER_ID_KEY, userId);
            }
            return userId;
        }
        
        // Initialize theme
        function initTheme() {
            const savedTheme = localStorage.getItem(THEME_KEY);
            const systemDark = prefersDarkScheme.matches;
            
            if (savedTheme === 'dark' || (!savedTheme && systemDark)) {
                document.body.classList.add('dark-theme');
            } else {
                document.body.classList.remove('dark-theme');
            }
        }
        
        // Toggle theme with animation
        function toggleTheme() {
            const isDark = document.body.classList.contains('dark-theme');
            
            themeTransition.classList.add('active');
            themeToggle.style.transform = 'scale(0.9)';
            
            setTimeout(() => {
                themeToggle.style.transform = 'scale(1)';
            }, 200);
            
            setTimeout(() => {
                if (isDark) {
                    document.body.classList.remove('dark-theme');
                    localStorage.setItem(THEME_KEY, 'light');
                } else {
                    document.body.classList.add('dark-theme');
                    localStorage.setItem(THEME_KEY, 'dark');
                }
                
                setTimeout(() => {
                    themeTransition.classList.remove('active');
                }, 400);
            }, 200);
        }
        
        // State
        let games = [];
        let filteredGames = [];
        let currentPage = 1;
        const gamesPerPage = 9;
        let isLoading = false;
        let currentSelectedRating = 0;
        let currentGameId = null;
        let currentUserRating = null;
        let isEditMode = false;
        let currentEditingGame = null;
        
        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            initTheme();
            initUserId();
            themeToggle.addEventListener('click', toggleTheme);
            
            prefersDarkScheme.addEventListener('change', (e) => {
                if (!localStorage.getItem(THEME_KEY)) {
                    initTheme();
                }
            });
            
            setTimeout(() => {
                initialLoading.classList.add('hidden');
            }, 1200);
            
            document.getElementById('gameDate').valueAsDate = new Date();
            await loadGames();
            setupEventListeners();
        });
        
        // Setup event listeners
        function setupEventListeners() {
            // Legal modals event listeners
document.querySelectorAll('.footer-link[data-modal]').forEach(link => {
    link.addEventListener('click', (e) => {
        e.preventDefault();
        const modalType = link.dataset.modal;
        showLegalModal(modalType);
    });
});

document.querySelectorAll('.legal-modal-close').forEach(btn => {
    btn.addEventListener('click', () => {
        const modalType = btn.dataset.modal;
        hideLegalModal(modalType);
    });
});

document.querySelectorAll('.legal-modal').forEach(modal => {
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            const modalId = modal.id.replace('Modal', '').toLowerCase();
            hideLegalModal(modalId);
        }
    });
});
// Show legal modal
function showLegalModal(type) {
    const modal = document.getElementById(`${type}Modal`);
    if (modal) {
        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
        
        // Close any other open modals
        closeAllModalsExcept(type);
    }
}

// Hide legal modal
function hideLegalModal(type) {
    const modal = document.getElementById(`${type}Modal`);
    if (modal) {
        modal.classList.remove('active');
        document.body.style.overflow = '';
    }
}

// Close all modals except the specified one
function closeAllModalsExcept(excludeType) {
    const modals = ['about', 'privacy', 'terms', 'contact', 'addGame', 'gameDetails'];
    modals.forEach(modalType => {
        if (modalType !== excludeType && modalType !== 'gameDetails') {
            const modal = document.getElementById(`${modalType}Modal`);
            if (modal) {
                modal.classList.remove('active');
            }
        }
    });
}
            searchInput.addEventListener('input', debounce(handleSearch, 300));
            document.getElementById('sortSelect').addEventListener('change', handleFilterChange);
            document.getElementById('genreFilter').addEventListener('change', handleFilterChange);
            document.getElementById('ratingFilter').addEventListener('change', handleFilterChange);
            document.getElementById('graphicsFilter').addEventListener('change', handleFilterChange);
            document.getElementById('ramFilter').addEventListener('change', handleFilterChange);
            document.getElementById('storageFilter').addEventListener('change', handleFilterChange);
            document.getElementById('loadMoreBtn').addEventListener('click', loadMoreGames);
            document.getElementById('openAddGameModal').addEventListener('click', openAddGameModal);
            document.getElementById('closeModal').addEventListener('click', () => toggleModal(false));
            document.getElementById('cancelBtn').addEventListener('click', () => toggleModal(false));
            document.getElementById('closeGameDetails').addEventListener('click', () => toggleGameDetailsModal(false));
            gameForm.addEventListener('submit', handleFormSubmit);
            document.getElementById('deleteGameBtn').addEventListener('click', deleteGame);
            
            // Rating stars
            const ratingStars = document.querySelectorAll('.rating-star');
            ratingStars.forEach(star => {
                star.addEventListener('click', handleStarClick);
                star.addEventListener('mouseover', handleStarHover);
            });
            
            document.getElementById('ratingStarsInput').addEventListener('mouseleave', resetStarHover);
            document.getElementById('submitRatingBtn').addEventListener('click', submitRating);
            document.getElementById('removeRatingBtn').addEventListener('click', removeRating);
            
            addGameModal.addEventListener('click', (e) => {
                if (e.target === addGameModal) toggleModal(false);
            });
            
            gameDetailsModal.addEventListener('click', (e) => {
                if (e.target === gameDetailsModal) toggleGameDetailsModal(false);
            });
            
            setupLazyLoading();
        }
        
        // Open add game modal (reset form)
        function openAddGameModal() {
            isEditMode = false;
            currentEditingGame = null;
            
            document.getElementById('modalTitle').textContent = 'Add New Game';
            document.getElementById('submitBtn').innerHTML = '<i class="fas fa-plus"></i> Add Game';
            document.getElementById('deleteGameBtn').style.display = 'none';
            document.getElementById('editGameId').value = '';
            
            // Reset form
            gameForm.reset();
            document.getElementById('gameDate').valueAsDate = new Date();
            
            toggleModal(true);
        }
        
        // Open edit game modal
        function openEditGameModal(game) {
            isEditMode = true;
            currentEditingGame = game;
            
            document.getElementById('modalTitle').textContent = 'Edit Game';
            document.getElementById('submitBtn').innerHTML = '<i class="fas fa-save"></i> Save Changes';
            document.getElementById('deleteGameBtn').style.display = 'block';
            document.getElementById('editGameId').value = game.id;
            
            // Fill form with game data
            document.getElementById('gameTitle').value = game.name;
            document.getElementById('gameGenre').value = game.genre;
            document.getElementById('gameDate').value = game.release_date;
            document.getElementById('gameDescription').value = game.description || '';
            document.getElementById('gameYoutubeId').value = game.youtube_id || '';
            document.getElementById('gameImage').value = game.image_url || '';
            
            // Fill system requirements
            if (game.requirements) {
                document.getElementById('gameGraphics').value = game.requirements.graphics || '';
                document.getElementById('gameRam').value = game.requirements.ram || '';
                document.getElementById('gameStorage').value = game.requirements.storage || '';
                document.getElementById('gameProcessor').value = game.requirements.processor || '';
            } else {
                document.getElementById('gameGraphics').value = '';
                document.getElementById('gameRam').value = '';
                document.getElementById('gameStorage').value = '';
                document.getElementById('gameProcessor').value = '';
            }
            
            toggleModal(true);
        }
        
        // Setup lazy loading
        function setupLazyLoading() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        if (img.dataset.src) {
                            img.src = img.dataset.src;
                            img.classList.remove('lazy-image');
                        }
                        observer.unobserve(img);
                    }
                });
            }, { rootMargin: '100px', threshold: 0.1 });
            
            const images = document.querySelectorAll('.game-cover img[data-src]');
            images.forEach(img => observer.observe(img));
            return observer;
        }
        
        // Load games from Supabase
       async function handleDonation() {
    try {
        showToast('🔄 Opening payment...', 'info');
        
        // Generate anonymous user ID for this session
        let anonymousId = localStorage.getItem('anonymousUserId');
        if (!anonymousId) {
            anonymousId = 'anon_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            localStorage.setItem('anonymousUserId', anonymousId);
        }
        
        console.log('Donation attempt by:', anonymousId);
        
        // Call YOUR Edge Function to create order
        const EDGE_FUNCTION_TOKEN = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpmY25kaXVvbWJtemVobm52YXdtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUzNTkyNTksImV4cCI6MjA4MDkzNTI1OX0.wfUvcghCIWsPAU7GhKS0H8GfyLotn_Kw2Zarwu4Z5ms';
        
        const response = await fetch('https://zfcndiuombmzehnnvawm.supabase.co/functions/v1/createOrder', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${EDGE_FUNCTION_TOKEN}`
            },
            body: JSON.stringify({ 
                amount: 10,
                receipt: `donation_${Date.now()}_${anonymousId}`,
                userId: anonymousId
            })
        });

        if (!response.ok) {
            const errorText = await response.text();
            console.error('❌ Order creation failed:', {
                status: response.status,
                error: errorText
            });
            
            // Fallback: Direct payment without Edge Function
            showToast('Using direct payment...', 'info');
            await directDonation(anonymousId);
            return;
        }

        const orderData = await response.json();
        console.log('✅ Order created:', orderData);
        
        if (!orderData.success) {
            console.error('Order creation not successful:', orderData);
            // Fallback to direct payment
            await directDonation(anonymousId);
            return;
        }

        // Load Razorpay SDK
        if (!window.Razorpay) {
            const script = document.createElement('script');
            script.src = 'https://checkout.razorpay.com/v1/checkout.js';
            document.body.appendChild(script);
            await new Promise((resolve, reject) => {
                script.onload = resolve;
                script.onerror = reject;
            });
        }

        const options = {
            key: orderData.key_id,
            amount: orderData.order.amount,
            currency: orderData.order.currency,
            name: "Choose a Game",
            description: "Support Gaming Database - ₹10",
            order_id: orderData.order.id,
            handler: async function(response) {
                console.log('✅ Payment successful:', response);
                
                try {
                    showToast('🔄 Verifying payment...', 'info');
                    
                    // Call verifyPayment Edge Function
                    const verifyResponse = await fetch(
                        'https://zfcndiuombmzehnnvawm.supabase.co/functions/v1/verifyPayment',
                        {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': `Bearer ${EDGE_FUNCTION_TOKEN}`
                            },
                            body: JSON.stringify({
                                razorpay_order_id: response.razorpay_order_id,
                                razorpay_payment_id: response.razorpay_payment_id,
                                razorpay_signature: response.razorpay_signature,
                                userId: anonymousId
                            })
                        }
                    );

                    const verification = await verifyResponse.json();
                    console.log('Verification result:', verification);
                    
                    if (verification.success) {
                        console.log('✅ Payment verified and stored');
                        showToast('❤️ Thank you for supporting us!', 'success');
                        updateDonationCount();
                    } else {
                        console.warn('⚠️ Verification failed:', verification);
                        showToast('❤️ Thank you! (Payment received)', 'success');
                        updateDonationCount();
                    }
                    
                } catch (error) {
                    console.error('Verification error:', error);
                    showToast('❤️ Thank you for your support!', 'success');
                    updateDonationCount();
                }
            },
            prefill: {
                name: "Supporter",
                email: "",
                contact: ""
            },
            theme: { color: "#FF6B6B" },
            modal: {
                ondismiss: function() {
                    showToast('Payment cancelled', 'info');
                }
            }
        };
        
        console.log('Opening Razorpay checkout...');
        const rzp = new window.Razorpay(options);
        rzp.open();
        
    } catch (error) {
        console.error('Donation error:', error);
        showToast(`Error: ${error.message}`, 'error');
    }
}

// Fallback function if Edge Function fails
async function directDonation(anonymousId) {
    try {
        // Use a test key as fallback
        const TEST_KEY = 'rzp_test_xxxxxxxxxxxx'; // Have a test key ready
        
        if (!window.Razorpay) {
            const script = document.createElement('script');
            script.src = 'https://checkout.razorpay.com/v1/checkout.js';
            document.body.appendChild(script);
            await new Promise(resolve => script.onload = resolve);
        }
        
        const options = {
            key: TEST_KEY,
            amount: 1000, // ₹10
            currency: 'INR',
            name: "Choose a Game",
            description: "Support Gaming Database - ₹10",
            handler: async function(response) {
                console.log('Direct payment successful:', response);
                
                // Still try to save to database
                try {
                    const donationData = {
                        payment_id: response.razorpay_payment_id,
                        order_id: 'direct_' + Date.now(),
                        amount: 10.00,
                        currency: 'INR',
                        user_id: anonymousId,
                        status: 'completed',
                        created_at: new Date().toISOString()
                    };
                    
                    await fetch(
                        'https://jqtpssafhjgvfjgebkuf.supabase.co/rest/v1/donations',
                        {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpxdHBzc2FmaGpndmZqZ2Via3VmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUyNDA3NDgsImV4cCI6MjA4MDgxNjc0OH0.AhtHlWU0dTzpfarZNG0QSAyRsnHYoAOQCovQf5thXkk',
                                'Prefer': 'return=minimal'
                            },
                            body: JSON.stringify(donationData)
                        }
                    );
                } catch (dbError) {
                    console.log('Could not save to DB, but payment successful');
                }
                
                showToast('❤️ Thank you for your support!', 'success');
                updateDonationCount();
            },
            theme: { color: "#FF6B6B" }
        };
        
        const rzp = new window.Razorpay(options);
        rzp.open();
        
    } catch (error) {
        console.error('Direct donation error:', error);
        showToast('Payment system unavailable. Please try again later.', 'error');
    }
}

// Update donation count
function updateDonationCount() {
    let totalCount = parseInt(localStorage.getItem('totalDonations') || '0');
    totalCount++;
    localStorage.setItem('totalDonations', totalCount.toString());
    
    // Update UI
    const donateBtn = document.getElementById('donateButton');
    if (donateBtn) {
        // Remove old badge
        const oldBadge = donateBtn.querySelector('.donation-badge');
        if (oldBadge) oldBadge.remove();
        
        // Add new badge
        donateBtn.classList.add('with-badge');
        const badge = document.createElement('span');
        badge.className = 'donation-badge';
        badge.textContent = totalCount;
        donateBtn.appendChild(badge);
    }
    
    console.log(`Total donations: ${totalCount}`);
}

// Initialize donation badge
function initDonationBadge() {
    const totalCount = localStorage.getItem('totalDonations');
    if (totalCount && parseInt(totalCount) > 0) {
        const donateBtn = document.getElementById('donateButton');
        if (donateBtn) {
            // Remove any existing badge
            const oldBadge = donateBtn.querySelector('.donation-badge');
            if (oldBadge) oldBadge.remove();
            
            // Add new badge
            donateBtn.classList.add('with-badge');
            const badge = document.createElement('span');
            badge.className = 'donation-badge';
            badge.textContent = totalCount;
            donateBtn.appendChild(badge);
        }
    }
}

// Add this CSS:
/*
.donate-btn.with-badge {
    position: relative;
}

.donation-badge {
    position: absolute;
    top: -8px;
    right: -8px;
    background: #10b981;
    color: white;
    font-size: 0.7rem;
    font-weight: bold;
    padding: 2px 6px;
    border-radius: 10px;
    min-width: 18px;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}
*/
// Also fix your user ID initialization - it's showing null
// Update your initUserId function:
function initUserId() {
    userId = localStorage.getItem(USER_ID_KEY);
    if (!userId) {
        userId = 'user_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now();
        localStorage.setItem(USER_ID_KEY, userId);
    }
    console.log('User ID:', userId); // Add this for debugging
    return userId;
}
        
        // Render games with lazy loading
        function renderGames() {
            const start = (currentPage - 1) * gamesPerPage;
            const end = start + gamesPerPage;
            const gamesToShow = filteredGames.slice(0, end);
            
            if (gamesToShow.length === 0) {
                emptyState.style.display = 'block';
                gamesGrid.innerHTML = '';
                gamesGrid.appendChild(emptyState);
                document.getElementById('loadMoreContainer').style.display = 'none';
                return;
            }
            
            emptyState.style.display = 'none';
            const fragment = document.createDocumentFragment();
            
            gamesToShow.forEach((game, index) => {
                const card = createGameCard(game, index);
                fragment.appendChild(card);
            });
            
            gamesGrid.innerHTML = '';
            gamesGrid.appendChild(fragment);
            
            setTimeout(() => {
                const observer = setupLazyLoading();
                const images = document.querySelectorAll('.game-cover img[data-src]');
                images.forEach(img => observer.observe(img));
            }, 100);
            
            const loadMoreContainer = document.getElementById('loadMoreContainer');
            const loadMoreBtn = document.getElementById('loadMoreBtn');
            
            if (filteredGames.length > end) {
                loadMoreContainer.style.display = 'block';
                loadMoreBtn.disabled = false;
                loadMoreBtn.innerHTML = '<i class="fas fa-chevron-down"></i> Load More';
            } else {
                loadMoreContainer.style.display = 'none';
            }
        }
        
        // Create game card
        function createGameCard(game, index) {
            const card = document.createElement('div');
            card.className = 'game-card';
            card.style.animationDelay = `${index * 0.1}s`;
            
            const stars = getStarRating(game.averageRating);
            const imageUrl = game.image_url || 'https://images.unsplash.com/photo-1550745165-9bc0b252726f?w=800&h=400&fit=crop&auto=format';
            
            // Get graphics badge
            const graphicsBadge = getGraphicsBadge(game.requirements?.graphics || '');
            
            card.innerHTML = `
                <div class="game-cover">
                    <img 
                        class="lazy-image"
                        data-src="${imageUrl}" 
                        alt="${game.name}"
                        onerror="this.src='https://images.unsplash.com/photo-1550745165-9bc0b252726f?w=800&h=400&fit=crop&auto=format'"
                    >
                    <div class="cover-overlay">
                        <div class="game-rating-badge">
                            <i class="fas fa-star"></i>
                            <span>${game.averageRating.toFixed(1)}/5</span>
                            ${graphicsBadge}
                        </div>
                    </div>
                    ${game.isOwner ? `
                        <div class="game-actions">
                            <button class="game-action-btn edit-game" title="Edit Game">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="game-action-btn delete delete-game" title="Delete Game">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    ` : ''}
                </div>
                <div class="game-info">
                    <div class="game-header">
                        <h3 class="game-title" title="${game.name}">${game.name}</h3>
                    </div>
                    ${game.created_by === userId ? `
                        <div class="game-creator">
                            <i class="fas fa-user"></i>
                            <span>Your Game</span>
                        </div>
                    ` : ''}
                    <div class="game-genre">${game.genre}</div>
                    <div class="game-meta">
                        <div class="game-date">
                            <i class="far fa-calendar"></i>
                            <span>${formatDate(game.release_date)}</span>
                        </div>
                        <div class="game-rating-stats">
                            <div class="game-rating-stars">${stars}</div>
                            <span class="game-rating-count">(${game.ratingCount})</span>
                        </div>
                    </div>
                </div>
            `;
            
            // Add click event to show game details
            card.addEventListener('click', (e) => {
                // Don't trigger if clicking on edit/delete buttons
                if (!e.target.closest('.game-action-btn')) {
                    showGameDetails(game);
                }
            });
            
            // Add edit/delete event listeners if user is owner
            if (game.isOwner) {
                const editBtn = card.querySelector('.edit-game');
                const deleteBtn = card.querySelector('.delete-game');
                
                editBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    openEditGameModal(game);
                });
                
                deleteBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    confirmDeleteGame(game);
                });
            }
            
            return card;
        }
        
        // Get graphics badge
        function getGraphicsBadge(graphics) {
            if (!graphics) return '';
            
            const badges = {
                'Integrated': '<span style="background: rgba(59, 130, 246, 0.1); color: #3b82f6; padding: 2px 6px; border-radius: 4px; font-size: 0.7rem; margin-left: 4px;">I</span>',
                'Dedicated Low': '<span style="background: rgba(34, 197, 94, 0.1); color: #22c55e; padding: 2px 6px; border-radius: 4px; font-size: 0.7rem; margin-left: 4px;">L</span>',
                'Dedicated Mid': '<span style="background: rgba(245, 158, 11, 0.1); color: #f59e0b; padding: 2px 6px; border-radius: 4px; font-size: 0.7rem; margin-left: 4px;">M</span>',
                'Dedicated High': '<span style="background: rgba(239, 68, 68, 0.1); color: #ef4444; padding: 2px 6px; border-radius: 4px; font-size: 0.7rem; margin-left: 4px;">H</span>'
            };
            
            return badges[graphics] || '';
        }
        
        // Show game details modal
        async function showGameDetails(game) {
            currentGameId = game.id;
            currentSelectedRating = 0;
            currentUserRating = null;
            
            // Get user's existing rating
            if (game.userRatings) {
                currentUserRating = game.userRatings.find(r => r.user_id === userId);
                if (currentUserRating) {
                    currentSelectedRating = currentUserRating.rating;
                }
            }
            
            // Update modal content
            document.getElementById('gameDetailsTitle').textContent = game.name;
            document.getElementById('gameDetailsGenre').textContent = game.genre;
            document.getElementById('gameDetailsDateText').textContent = formatDate(game.release_date);
            document.getElementById('gameDetailsImage').src = game.image_url || 'https://images.unsplash.com/photo-1550745165-9bc0b252726f?w=800&h=400&fit=crop&auto=format';
            
            // Update rating display
            const stars = getStarRating(game.averageRating);
            document.getElementById('gameDetailsRatingStars').innerHTML = stars;
            document.getElementById('gameDetailsRatingValue').textContent = `${game.averageRating.toFixed(1)}/5`;
            document.getElementById('gameDetailsRatingCount').textContent = `(${game.ratingCount} ratings)`;
            
            // Update description
            document.getElementById('gameDetailsDescription').innerHTML = `<p>${game.description || 'No description available.'}</p>`;
            
            // Update system requirements
            const requirementsList = document.getElementById('requirementsList');
            requirementsList.innerHTML = '';
            
            if (game.requirements && Object.keys(game.requirements).length > 0) {
                const reqItems = [
                    { icon: 'fa-microchip', label: 'Graphics', value: game.requirements.graphics || 'Not specified' },
                    { icon: 'fa-memory', label: 'RAM', value: game.requirements.ram ? `${game.requirements.ram} GB` : 'Not specified' },
                    { icon: 'fa-hard-drive', label: 'Storage', value: game.requirements.storage ? `${game.requirements.storage} GB` : 'Not specified' },
                    { icon: 'fa-microchip', label: 'Processor', value: game.requirements.processor || 'Not specified' }
                ];
                
                reqItems.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'requirement-item';
                    div.innerHTML = `
                        <i class="fas ${item.icon}"></i>
                        <span>${item.label}:</span>
                        <span class="requirement-value">${item.value}</span>
                    `;
                    requirementsList.appendChild(div);
                });
            } else {
                requirementsList.innerHTML = '<p style="color: var(--color-text-muted);">No system requirements specified.</p>';
            }
            
            // Parse YouTube URL/ID
            let youtubeId = game.youtube_id;
            if (youtubeId) {
                youtubeId = extractYouTubeId(youtubeId);
            }
            
            const youtubePlayer = document.getElementById('youtubePlayer');
            
            if (youtubeId) {
                youtubePlayer.innerHTML = `
                    <iframe 
                        width="560" 
                        height="315" 
                        src="https://www.youtube.com/embed/${youtubeId}?autoplay=1&mute=1&controls=1&loop=1&playlist=${youtubeId}"
                        title="YouTube video player"
                        frameborder="0"
                        allow="autoplay; encrypted-media"
                        allowfullscreen>
                    </iframe>
                `;
            } else {
                youtubePlayer.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: center; height: 100%; background: var(--color-bg-card); color: var(--color-text-muted);">
                        <div style="text-align: center; padding: 2rem;">
                            <i class="fas fa-video" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                            <p>No trailer available</p>
                        </div>
                    </div>
                `;
            }
            
            // Update edit/delete buttons in modal header if user is owner
            const actionsContainer = document.getElementById('gameDetailsActions');
            actionsContainer.innerHTML = '';
            
            if (game.created_by === userId) {
                actionsContainer.innerHTML = `
                    <button class="game-details-action-btn edit-game" title="Edit Game">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="game-details-action-btn delete delete-game" title="Delete Game">
                        <i class="fas fa-trash"></i>
                    </button>
                `;
                
                // Add event listeners for modal buttons
                actionsContainer.querySelector('.edit-game').addEventListener('click', () => {
                    toggleGameDetailsModal(false);
                    setTimeout(() => openEditGameModal(game), 300);
                });
                
                actionsContainer.querySelector('.delete-game').addEventListener('click', () => {
                    toggleGameDetailsModal(false);
                    setTimeout(() => confirmDeleteGame(game), 300);
                });
            }
            
            // Update rating stars based on user's existing rating
            const ratingStars = document.querySelectorAll('.rating-star');
            ratingStars.forEach(star => {
                const value = parseInt(star.dataset.value);
                if (value <= currentSelectedRating) {
                    star.classList.add('active');
                    star.textContent = '★';
                } else {
                    star.classList.remove('active');
                    star.textContent = '☆';
                }
            });
            
            // Update user rating info
            const userRatingInfo = document.getElementById('userRatingInfo');
            const submitBtn = document.getElementById('submitRatingBtn');
            const removeBtn = document.getElementById('removeRatingBtn');
            
            if (currentUserRating) {
                userRatingInfo.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 0.5rem; color: var(--color-accent-green); font-weight: 500;">
                        <i class="fas fa-check-circle"></i>
                        <span>Your rating: ${currentUserRating.rating}/5</span>
                    </div>
                `;
                submitBtn.textContent = 'Update Rating';
                removeBtn.style.display = 'block';
                submitBtn.disabled = false;
            } else {
                userRatingInfo.innerHTML = '';
                submitBtn.textContent = 'Submit Rating';
                removeBtn.style.display = 'none';
                submitBtn.disabled = currentSelectedRating === 0;
            }
            
            // Show modal
            toggleGameDetailsModal(true);
        }
        
        // Extract YouTube ID from various URL formats
        function extractYouTubeId(urlOrId) {
            if (!urlOrId) return null;
            
            // If it's already just an ID
            if (urlOrId.length === 11 && !urlOrId.includes('/')) {
                return urlOrId;
            }
            
            try {
                // Handle various YouTube URL formats
                const patterns = [
                    /(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/|youtube\.com\/v\/|youtube\.com\/watch\?.*v=)([^&\n?#]+)/,
                    /^([a-zA-Z0-9_-]{11})$/
                ];
                
                for (const pattern of patterns) {
                    const match = urlOrId.match(pattern);
                    if (match && match[1]) {
                        return match[1];
                    }
                }
                
                return null;
            } catch (e) {
                console.error('Error extracting YouTube ID:', e);
                return null;
            }
        }
        
        // Toggle game details modal
        function toggleGameDetailsModal(show) {
            if (show) {
                gameDetailsModal.classList.add('active');
                document.body.style.overflow = 'hidden';
            } else {
                gameDetailsModal.classList.remove('active');
                document.body.style.overflow = '';
                // Stop YouTube video when closing modal
                const iframe = document.querySelector('#youtubePlayer iframe');
                if (iframe) {
                    iframe.src = iframe.src.replace('autoplay=1', 'autoplay=0');
                }
            }
        }
        
        // Handle star rating hover
        function handleStarHover(e) {
            const value = parseInt(e.target.dataset.value);
            const stars = document.querySelectorAll('.rating-star');
            
            stars.forEach((star, index) => {
                if (index < value) {
                    star.textContent = '★';
                    star.style.color = 'var(--color-rating)';
                } else {
                    star.textContent = '☆';
                    star.style.color = 'var(--color-border)';
                }
            });
        }
        
        // Handle star click
        function handleStarClick(e) {
            currentSelectedRating = parseInt(e.target.dataset.value);
            const stars = document.querySelectorAll('.rating-star');
            
            stars.forEach((star, index) => {
                if (index < currentSelectedRating) {
                    star.classList.add('active');
                    star.textContent = '★';
                } else {
                    star.classList.remove('active');
                    star.textContent = '☆';
                }
            });
            
            document.getElementById('submitRatingBtn').disabled = false;
        }
        
        // Reset star hover
        function resetStarHover() {
            const stars = document.querySelectorAll('.rating-star');
            stars.forEach((star, index) => {
                if (index < currentSelectedRating) {
                    star.textContent = '★';
                    star.style.color = 'var(--color-rating)';
                } else {
                    star.textContent = '☆';
                    star.style.color = 'var(--color-border)';
                }
            });
        }
        
        // Submit rating
        async function submitRating() {
            if (!currentGameId || !currentSelectedRating) return;
            
            const submitBtn = document.getElementById('submitRatingBtn');
            const originalText = submitBtn.textContent;
            
            submitBtn.disabled = true;
            submitBtn.textContent = currentUserRating ? 'Updating...' : 'Submitting...';
            
            try {
                if (currentUserRating) {
                    // Update existing rating
                    const { error: updateError } = await supabase
                        .from('ratings')
                        .update({ 
                            rating: currentSelectedRating, 
                            updated_at: new Date().toISOString() 
                        })
                        .eq('game_id', currentGameId)
                        .eq('user_id', userId);
                    
                    if (updateError) throw updateError;
                    
                    showToast('Rating updated successfully!', 'success');
                } else {
                    // Insert new rating
                    const { error: insertError } = await supabase
                        .from('ratings')
                        .insert([{
                            game_id: currentGameId,
                            user_id: userId,
                            rating: currentSelectedRating,
                            created_at: new Date().toISOString()
                        }]);
                    
                    if (insertError) throw insertError;
                    
                    showToast('Rating submitted successfully!', 'success');
                }
                
                // Refresh game data
                setTimeout(async () => {
                    await loadGames();
                    // Update current game display
                    const currentGame = games.find(g => g.id === currentGameId);
                    if (currentGame) {
                        await showGameDetails(currentGame);
                    }
                }, 1000);
                
            } catch (error) {
                console.error('Error submitting rating:', error);
                showToast('Failed to submit rating', 'error');
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        }
        
        // Remove rating
        async function removeRating() {
            if (!currentGameId || !currentUserRating) return;
            
            const removeBtn = document.getElementById('removeRatingBtn');
            const originalText = removeBtn.textContent;
            
            removeBtn.disabled = true;
            removeBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Removing...';
            
            try {
                const { error } = await supabase
                    .from('ratings')
                    .delete()
                    .eq('game_id', currentGameId)
                    .eq('user_id', userId);
                
                if (error) throw error;
                
                showToast('Rating removed successfully!', 'success');
                
                // Refresh game data
                setTimeout(async () => {
                    await loadGames();
                    // Update current game display
                    const currentGame = games.find(g => g.id === currentGameId);
                    if (currentGame) {
                        await showGameDetails(currentGame);
                    }
                }, 1000);
                
            } catch (error) {
                console.error('Error removing rating:', error);
                showToast('Failed to remove rating', 'error');
                removeBtn.disabled = false;
                removeBtn.innerHTML = originalText;
            }
        }
        
        // Load more games
        function loadMoreGames() {
            if (isLoading) return;
            
            const btn = document.getElementById('loadMoreBtn');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Loading...';
            
            setTimeout(() => {
                currentPage++;
                renderGames();
            }, 600);
        }
        
        // Handle search and filtering
        function handleSearch() {
            const searchTerm = searchInput.value.toLowerCase().trim();
            const genre = document.getElementById('genreFilter').value;
            const rating = parseFloat(document.getElementById('ratingFilter').value) || 0;
            const graphics = document.getElementById('graphicsFilter').value;
            const ram = parseInt(document.getElementById('ramFilter').value) || 0;
            const storage = parseInt(document.getElementById('storageFilter').value) || 0;
            const sortBy = document.getElementById('sortSelect').value;
            
            filteredGames = games.filter(game => {
                const matchesSearch = !searchTerm || 
                    game.name.toLowerCase().includes(searchTerm) ||
                    game.genre.toLowerCase().includes(searchTerm) ||
                    (game.description && game.description.toLowerCase().includes(searchTerm));
                
                const matchesGenre = !genre || game.genre === genre;
                const matchesRating = !rating || game.averageRating >= rating;
                
                // Check system requirements filters
                const matchesGraphics = !graphics || 
                    (game.requirements && game.requirements.graphics === graphics);
                
                const matchesRam = !ram || 
                    (game.requirements && game.requirements.ram && game.requirements.ram <= ram);
                
                const matchesStorage = !storage || 
                    (game.requirements && game.requirements.storage && game.requirements.storage <= storage);
                
                return matchesSearch && matchesGenre && matchesRating && 
                       matchesGraphics && matchesRam && matchesStorage;
            });
            
            // Sort
            filteredGames.sort((a, b) => {
                switch (sortBy) {
                    case 'rating':
                        return b.averageRating - a.averageRating;
                    case 'name':
                        return a.name.localeCompare(b.name);
                    case 'date':
                    default:
                        return new Date(b.release_date) - new Date(a.release_date);
                }
            });
            
            currentPage = 1;
            renderGames();
        }
        
        function handleFilterChange() {
            handleSearch();
        }
        
        // Toggle add game modal
        function toggleModal(show) {
            if (show) {
                addGameModal.classList.add('active');
                document.body.style.overflow = 'hidden';
            } else {
                addGameModal.classList.remove('active');
                document.body.style.overflow = '';
                gameForm.reset();
                document.getElementById('gameDate').valueAsDate = new Date();
            }
        }
        
        // Handle form submission (add/edit)
        async function handleFormSubmit(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const originalText = submitBtn.innerHTML;
            
            try {
                submitBtn.disabled = true;
                submitBtn.innerHTML = isEditMode 
                    ? '<i class="fas fa-spinner fa-spin"></i> Saving...'
                    : '<i class="fas fa-spinner fa-spin"></i> Adding...';
                
                // Extract YouTube ID from input
                const youtubeInput = document.getElementById('gameYoutubeId').value.trim();
                const youtubeId = extractYouTubeId(youtubeInput);
                
                if (!youtubeId) {
                    throw new Error('Please enter a valid YouTube URL or ID');
                }
                
                // Prepare system requirements
                const systemRequirements = {
                    graphics: document.getElementById('gameGraphics').value || null,
                    ram: document.getElementById('gameRam').value ? parseInt(document.getElementById('gameRam').value) : null,
                    storage: document.getElementById('gameStorage').value ? parseInt(document.getElementById('gameStorage').value) : null,
                    processor: document.getElementById('gameProcessor').value || null
                };
                
                const gameData = {
                    name: document.getElementById('gameTitle').value.trim(),
                    genre: document.getElementById('gameGenre').value,
                    release_date: document.getElementById('gameDate').value,
                    description: document.getElementById('gameDescription').value.trim(),
                    youtube_id: youtubeId,
                    image_url: document.getElementById('gameImage').value.trim() || null,
                    system_requirements: systemRequirements,
                    created_by: userId
                };
                
                // Validation
                if (!gameData.name || !gameData.genre || !gameData.release_date || !gameData.description) {
                    throw new Error('Please fill in all required fields');
                }
                
                if (isEditMode && currentEditingGame) {
                    // Update existing game
                    const gameId = document.getElementById('editGameId').value;
                    
                    const { data, error } = await supabase
                        .from('games')
                        .update(gameData)
                        .eq('id', gameId)
                        .eq('created_by', userId) // Ensure user owns the game
                        .select();
                    
                    if (error) throw error;
                    
                    if (data.length === 0) {
                        throw new Error('Game not found or you do not have permission to edit it');
                    }
                    
                    showToast('Game updated successfully! 🎮', 'success');
                } else {
                    // Add new game
                    gameData.created_at = new Date().toISOString();
                    
                    const { data, error } = await supabase
                        .from('games')
                        .insert([gameData])
                        .select();
                    
                    if (error) throw error;
                    
                    showToast('Game added successfully! 🎮', 'success');
                }
                
                // Refresh game data
                await loadGames();
                toggleModal(false);
                
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
            } catch (error) {
                console.error('Error saving game:', error);
                showToast(error.message || 'Failed to save game', 'error');
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalText;
            }
        }
        // Add with your other DOM selectors (around line 850)
const donateButton = document.getElementById('donateButton');

// Add with your other event listeners (around line 950)
donateButton.addEventListener('click', handleDonation);

async function handleDonation() {
    try {
        showToast('🔄 Creating donation order...', 'info');
        
        const response = await fetch('https://zfcndiuombmzehnnvawm.supabase.co/functions/v1/createOrder', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXAhYmFzZSIsInJlZiI6InpmY25kaXVvbWJtemVobm52YXdtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUzNTkyNTksImV4cCI6MjA4MDkzNTI1OX0.wfUvcghCIWsPAU7GhKS0H8GfyLotn_Kw2Zarwu4Z5ms'
            },
            body: JSON.stringify({ 
                amount: 10,
                receipt: `donation_${Date.now()}_${userId || 'anonymous'}`,
                userId: userId || 'anonymous'
            })
        });

        if (!response.ok) {
            throw new Error(`Failed to create order: ${response.status}`);
        }

        const orderData = await response.json();
        
        if (!orderData.success) {
            throw new Error(orderData.error || 'Payment setup failed');
        }

        console.log('Key ID received:', orderData.key_id);
        
        await loadRazorpayScript();

        const options = {
            key: orderData.key_id,
            amount: orderData.order.amount,
            currency: orderData.order.currency,
            name: "Choose a Game",
            description: "Community Support Donation - ₹10",
            order_id: orderData.order.id,
            handler: async function(response) {
                console.log('Payment response:', response);
                
                try {
                    // Show loading toast
                    showToast('🔄 Verifying payment with server...', 'info');
                    
                    // Call verifyPayment function
                    const verifyResponse = await fetch(
                        'https://zfcndiuombmzehnnvawm.supabase.co/functions/v1/verifyPayment',
                        {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpmY25kaXVvbWJtemVobm52YXdtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUzNTkyNTksImV4cCI6MjA4MDkzNTI1OX0.wfUvcghCIWsPAU7GhKS0H8GfyLotn_Kw2Zarwu4Z5ms'
                            },
                            body: JSON.stringify({
                                razorpay_order_id: response.razorpay_order_id,
                                razorpay_payment_id: response.razorpay_payment_id,
                                razorpay_signature: response.razorpay_signature,
                                userId: userId || 'anonymous'
                            })
                        }
                    );

                    const verification = await verifyResponse.json();
                    
                    if (verification.success) {
                        console.log('✅ Payment verified:', verification);
                        showToast('❤️ Thank you for your support! Payment verified.', 'success');
                        
                        // Update donation count locally
                        trackDonation();
                    } else {
                        console.error('❌ Payment verification failed:', verification);
                        showToast(`⚠️ ${verification.error || 'Payment verification failed'}`, 'error');
                    }
                    
                } catch (error) {
                    console.error('🔥 Verification error:', error);
                    showToast('⚠️ Could not verify payment. Please contact support.', 'error');
                }
            },
            prefill: {
                name: "Supporter",
                email: "",
                contact: ""
            },
            theme: { color: "#FF6B6B" },
            modal: {
                ondismiss: function() {
                    console.log('Payment modal closed');
                    showToast('Payment cancelled', 'info');
                }
            }
        };

        const rzp = new window.Razorpay(options);
        rzp.open();

    } catch (error) {
        console.error('Donation setup error:', error);
        showToast(`Error: ${error.message}`, 'error');
    }
}

// Helper function to load Razorpay script
function loadRazorpayScript() {
    return new Promise((resolve, reject) => {
        if (window.Razorpay) {
            console.log('Razorpay already loaded');
            resolve();
            return;
        }
        
        const script = document.createElement('script');
        script.src = 'https://checkout.razorpay.com/v1/checkout.js';
        script.onload = () => {
            console.log('✅ Razorpay SDK loaded');
            resolve();
        };
        script.onerror = (error) => {
            console.error('❌ Failed to load Razorpay SDK:', error);
            reject(new Error('Failed to load payment system'));
        };
        document.body.appendChild(script);
    });
}

// Update trackDonation function
function trackDonation() {
    let donationCount = parseInt(localStorage.getItem('donationCount') || '0');
    donationCount++;
    localStorage.setItem('donationCount', donationCount.toString());
    
    // Update UI if you have a badge
    const badge = document.querySelector('.donation-badge');
    if (badge) {
        badge.textContent = donationCount;
        badge.style.display = 'inline-block';
    }
    
    console.log(`Donation count: ${donationCount}`);
    return donationCount;
}

// Initialize donation badge on page load
function initDonationBadge() {
    const donationCount = localStorage.getItem('donationCount');
    if (donationCount && parseInt(donationCount) > 0) {
        // Add badge to button if not exists
        if (!donationButton.querySelector('.donation-badge')) {
            donationButton.classList.add('with-badge');
            const badge = document.createElement('span');
            badge.className = 'donation-badge';
            badge.textContent = donationCount;
            donationButton.appendChild(badge);
        }
    }
}

// Call this in your initialization
// initDonationBadge();

function loadRazorpayScript() {
    return new Promise((resolve, reject) => {
        if (window.Razorpay) {
            resolve();
            return;
        }
        
        const script = document.createElement('script');
        script.src = 'https://checkout.razorpay.com/v1/checkout.js';
        script.onload = () => resolve();
        script.onerror = () => reject(new Error('Failed to load Razorpay SDK'));
        document.body.appendChild(script);
    });
}

// Optional: Track donations locally
function trackDonation() {
    let donationCount = localStorage.getItem('donationCount') || 0;
    donationCount++;
    localStorage.setItem('donationCount', donationCount);
    
    // Update UI if you add a badge
    const badge = document.querySelector('.donation-badge');
    if (badge) {
        badge.textContent = donationCount;
    }
    
    return donationCount;
}

// Optional: Show donation modal first
function showDonationModal() {
    const modal = document.createElement('div');
    modal.className = 'donation-modal';
    modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0,0,0,0.7);
        backdrop-filter: blur(10px);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
    `;
    
    modal.innerHTML = `
        <div style="
            background: var(--color-bg-modal);
            padding: 2rem;
            border-radius: 20px;
            max-width: 400px;
            text-align: center;
            border: 1px solid var(--color-border);
            box-shadow: var(--shadow-modal);
        ">
            <i class="fas fa-heart" style="font-size: 3rem; color: #FF6B6B; margin-bottom: 1rem;"></i>
            <h2 style="margin-bottom: 1rem; color: var(--color-text-primary);">Support Our Community</h2>
            <p style="color: var(--color-text-secondary); margin-bottom: 1.5rem;">
                Help us keep Choose a Game running and free for everyone!<br>
                Every ₹10 helps improve the database for all gamers.
            </p>
            <div style="display: flex; gap: 1rem; justify-content: center;">
                <button id="cancelDonation" style="
                    padding: 12px 24px;
                    background: var(--color-bg-hover);
                    color: var(--color-text-secondary);
                    border: 2px solid var(--color-border);
                    border-radius: 10px;
                    font-weight: 600;
                    cursor: pointer;
                ">Maybe Later</button>
                <button id="confirmDonation" style="
                    padding: 12px 24px;
                    background: linear-gradient(135deg, #FF6B6B 0%, #FF8E8E 100%);
                    color: white;
                    border: none;
                    border-radius: 10px;
                    font-weight: 600;
                    cursor: pointer;
                ">
                    <i class="fas fa-heart"></i> Donate ₹10
                </button>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    
    modal.querySelector('#cancelDonation').addEventListener('click', () => {
        document.body.removeChild(modal);
    });
    
    modal.querySelector('#confirmDonation').addEventListener('click', () => {
        document.body.removeChild(modal);
        handleDonation();
    });
    
    // Close when clicking outside
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            document.body.removeChild(modal);
        }
    });
}

// Optional: Initialize donation badge on page load
function initDonationBadge() {
    const donationCount = localStorage.getItem('donationCount');
    if (donationCount && parseInt(donationCount) > 0) {
        // Add badge to button
        donateButton.classList.add('with-badge');
        const badge = document.createElement('span');
        badge.className = 'donation-badge';
        badge.textContent = donationCount;
        donateButton.appendChild(badge);
    }
}

// Call on page load (add to your init function)
initDonationBadge();

// Optional: Change button to show modal instead of direct link
// donateButton.addEventListener('click', showDonationModal);
        
        // Confirm delete game
        function confirmDeleteGame(game) {
            if (confirm(`Are you sure you want to delete "${game.name}"? This action cannot be undone.`)) {
                deleteGame(game.id);
            }
        }
        
        // Delete game
        async function deleteGame(gameId = null) {
            const idToDelete = gameId || document.getElementById('editGameId').value;
            if (!idToDelete) return;
            
            const deleteBtn = document.getElementById('deleteGameBtn');
            const originalText = deleteBtn.innerHTML;
            
            try {
                deleteBtn.disabled = true;
                deleteBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Deleting...';
                
                // First delete all ratings for this game
                const { error: ratingsError } = await supabase
                    .from('ratings')
                    .delete()
                    .eq('game_id', idToDelete);
                
                if (ratingsError) throw ratingsError;
                
                // Then delete the game
                const { error: gameError } = await supabase
                    .from('games')
                    .delete()
                    .eq('id', idToDelete)
                    .eq('created_by', userId); // Ensure user owns the game
                
                if (gameError) throw gameError;
                
                showToast('Game deleted successfully!', 'success');
                
                // Refresh game data
                await loadGames();
                toggleModal(false);
                toggleGameDetailsModal(false);
                
            } catch (error) {
                console.error('Error deleting game:', error);
                showToast('Failed to delete game. You may not have permission.', 'error');
            } finally {
                deleteBtn.disabled = false;
                deleteBtn.innerHTML = originalText;
            }
        }
        
        // Show toast notification
        function showToast(message, type = 'info') {
            toast.textContent = message;
            toast.className = `toast ${type}`;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Utility functions
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }
        
        function getStarRating(rating) {
            const fullStars = Math.floor(rating);
            const halfStar = rating % 1 >= 0.5;
            const emptyStars = 5 - fullStars - (halfStar ? 1 : 0);
            
            return '★'.repeat(fullStars) + (halfStar ? '½' : '') + '☆'.repeat(emptyStars);
        }
        
        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                searchInput.focus();
            }
            
            if (e.key === 'Escape') {
                toggleModal(false);
                toggleGameDetailsModal(false);
            }
            
            if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                e.preventDefault();
                if (!addGameModal.classList.contains('active')) {
                    openAddGameModal();
                }
            }
            
            if ((e.ctrlKey || e.metaKey) && e.key === '/') {
                e.preventDefault();
                toggleTheme();
            }
        });
        
        
        // Console welcome message
        console.log('%c🎮 Choose a Game 🎮', 'font-size: 20px; font-weight: bold; color: #00b0fc;');
        console.log('%cWelcome to your gaming database!', 'color: #64748b;');
        console.log('%cFeatures:', 'font-weight: bold; color: #10b981;');
        console.log('• Rate games with star ratings (one per user)');
        console.log('• Add, edit, and delete your own games');
        console.log('• View game details with YouTube trailers');
        console.log('• Filter by system requirements (GPU, RAM, Storage)');
        console.log('• Dark/Light mode with animations');
        console.log('%cUser ID:', 'font-weight: bold; color: #8b5cf6;');
        console.log(userId);
    </script>
</body>
</html>

